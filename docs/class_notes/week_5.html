<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Corpus Studies in Music - Week 5: Testing Hypotheses with Spotify</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../class_notes/week_4.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta property="og:title" content="Corpus Studies in Music - Week 5: Testing Hypotheses with Spotify">
<meta property="og:description" content="This week, we will be going over:">
<meta property="og:site-name" content="Corpus Studies in Music">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Week 5: Testing Hypotheses with Spotify</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Corpus Studies in Music</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Resources</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-syllabus.html" class="sidebar-item-text sidebar-link">Corpus Studies (Music 348/448) Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-schedule.html" class="sidebar-item-text sidebar-link">Course Schedule</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Class Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_1.html" class="sidebar-item-text sidebar-link">Week 1: Representing Musical Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_2.html" class="sidebar-item-text sidebar-link">Week 2: Pitch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_3.html" class="sidebar-item-text sidebar-link">Week 3: Time</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_4.html" class="sidebar-item-text sidebar-link">Week 4: Conceptual Debates: Key-Finding</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_5.html" class="sidebar-item-text sidebar-link active">Week 5: Testing Hypotheses with Spotify</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#plan-for-the-week" id="toc-plan-for-the-week" class="nav-link active" data-scroll-target="#plan-for-the-week">Plan for the Week</a></li>
  <li><a href="#literature-reviews" id="toc-literature-reviews" class="nav-link" data-scroll-target="#literature-reviews">Literature Reviews</a></li>
  <li><a href="#testing-a-hypothesis-with-continuous-data" id="toc-testing-a-hypothesis-with-continuous-data" class="nav-link" data-scroll-target="#testing-a-hypothesis-with-continuous-data">Testing a Hypothesis with Continuous Data</a></li>
  <li><a href="#hypothesis-1-do-jay-zs-songs-get-slower-over-time" id="toc-hypothesis-1-do-jay-zs-songs-get-slower-over-time" class="nav-link" data-scroll-target="#hypothesis-1-do-jay-zs-songs-get-slower-over-time">Hypothesis 1: Do Jay-Z’s Songs Get Slower Over Time?</a>
  <ul class="collapse">
  <li><a href="#looking-at-tempo-over-time" id="toc-looking-at-tempo-over-time" class="nav-link" data-scroll-target="#looking-at-tempo-over-time">Looking at tempo over time</a>
  <ul class="collapse">
  <li><a href="#post-hoc-analyses" id="toc-post-hoc-analyses" class="nav-link" data-scroll-target="#post-hoc-analyses">Post-Hoc Analyses</a></li>
  </ul></li>
  <li><a href="#sidenote-isare-the-data-normal" id="toc-sidenote-isare-the-data-normal" class="nav-link" data-scroll-target="#sidenote-isare-the-data-normal">Sidenote: Is/Are the data normal?</a></li>
  <li><a href="#stepwise-entry-regression" id="toc-stepwise-entry-regression" class="nav-link" data-scroll-target="#stepwise-entry-regression">Stepwise Entry Regression</a></li>
  <li><a href="#comparing-fits" id="toc-comparing-fits" class="nav-link" data-scroll-target="#comparing-fits">Comparing Fits:</a></li>
  <li><a href="#is-a-linear-model-the-best-approach" id="toc-is-a-linear-model-the-best-approach" class="nav-link" data-scroll-target="#is-a-linear-model-the-best-approach">Is a linear model the best approach?</a></li>
  <li><a href="#predicting-a-categorical-variable" id="toc-predicting-a-categorical-variable" class="nav-link" data-scroll-target="#predicting-a-categorical-variable">Predicting a categorical variable</a></li>
  </ul></li>
  <li><a href="#wednesday" id="toc-wednesday" class="nav-link" data-scroll-target="#wednesday">Wednesday</a>
  <ul class="collapse">
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a>
  <ul class="collapse">
  <li><a href="#how-does-the-r-hclust-function-work" id="toc-how-does-the-r-hclust-function-work" class="nav-link" data-scroll-target="#how-does-the-r-hclust-function-work">How does the R hclust function work?</a></li>
  </ul></li>
  <li><a href="#which-track-belongs-to-which-cluster" id="toc-which-track-belongs-to-which-cluster" class="nav-link" data-scroll-target="#which-track-belongs-to-which-cluster">Which track belongs to which cluster?</a>
  <ul class="collapse">
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-Means Clustering</a></li>
  </ul></li>
  <li><a href="#example-1-looking-at-nirvana-albumss" id="toc-example-1-looking-at-nirvana-albumss" class="nav-link" data-scroll-target="#example-1-looking-at-nirvana-albumss">Example 1: Looking at Nirvana Albumss</a>
  <ul class="collapse">
  <li><a href="#k-means-clustering-1" id="toc-k-means-clustering-1" class="nav-link" data-scroll-target="#k-means-clustering-1">k-means clustering</a></li>
  </ul></li>
  <li><a href="#conditional-inference-tree-with-party" id="toc-conditional-inference-tree-with-party" class="nav-link" data-scroll-target="#conditional-inference-tree-with-party">Conditional Inference Tree with Party</a></li>
  <li><a href="#christmas-or-not" id="toc-christmas-or-not" class="nav-link" data-scroll-target="#christmas-or-not">Christmas or Not?</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/shanahdt/corpus-studies/edit/main/class_notes/week_5.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/shanahdt/corpus-studies/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Week 5: Testing Hypotheses with Spotify</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="plan-for-the-week" class="level1">
<h1>Plan for the Week</h1>
<p>This week, we will be going over:</p>
<ul>
<li>basics for your mid-term literature review</li>
<li>testing some basic hypotheses of continuous data with linear regression</li>
<li>testing some basic hypotheses of categorical data with logistic regressions</li>
<li>evaluating model fits</li>
</ul>
</section>
<section id="literature-reviews" class="level1">
<h1>Literature Reviews</h1>
<ul>
<li>Be sure to include an overview of previous research related to the topic. If you’re interested in how tempo changes over time in hip-hop, for example, you should include sources on tempo change, hip-hop styles, and changing performance practice within the genre.
<ul>
<li>It need not be all-encompassing, but it should try to cover as much ground as possible.</li>
</ul></li>
<li>Address a gap in the current literature, or that between theory and research. End with a discussion of your study, and how it hopes to fill in these gaps.</li>
<li>There is a rubric online.</li>
<li>Purdue’s writing lab has a good page about it <a href="https://owl.purdue.edu/owl/research_and_citation/conducting_research/writing_a_literature_review.html">here</a>.</li>
</ul>
</section>
<section id="testing-a-hypothesis-with-continuous-data" class="level1">
<h1>Testing a Hypothesis with Continuous Data</h1>
<p>Although we’ve spent a fair bit of time going over the mechanics of the Spotify data, and how to extract information from it, we haven’t spent much time actually discussing testing hypotheses with your data. As many of you are doing hypothesis-based work for your final project, it might be a good time to step back and look some approaches to this.</p>
</section>
<section id="hypothesis-1-do-jay-zs-songs-get-slower-over-time" class="level1">
<h1>Hypothesis 1: Do Jay-Z’s Songs Get Slower Over Time?</h1>
<p>I think that Jay-Z’s songs are getting slower over time. Let’s test it.</p>
<p>We’ll start by grabbing our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>jayz <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'Jay-Z'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="looking-at-tempo-over-time" class="level2">
<h2 class="anchored" data-anchor-id="looking-at-tempo-over-time">Looking at tempo over time</h2>
<p>We can start by eyeballing the data. Here is how we’d do it with base R (no ggplot/tidyverse):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tempo <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(tempo <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If we’d like to use <code>ggplot</code> it can give us some confidence bars (the default here is a 95% confidence interval):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jayz, <span class="fu">aes</span>(album_release_year, tempo) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So it looks promising. We can run a linear regression with a simple <code>lm</code> command. Here we can get a <code>summary</code> of the model pretty easily, as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(tempo <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tempo ~ album_release_year, data = jayz)

Residuals:
   Min     1Q Median     3Q    Max 
-44.84 -21.17 -11.79  12.22  92.18 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        -2158.9919   396.7564  -5.442 6.99e-08 ***
album_release_year     1.1306     0.1979   5.714 1.55e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 30.94 on 815 degrees of freedom
Multiple R-squared:  0.03852,   Adjusted R-squared:  0.03734 
F-statistic: 32.65 on 1 and 815 DF,  p-value: 1.547e-08</code></pre>
</div>
</div>
<p>So, as we can see from the results here, it’s significant (p &lt; .001), but it really doesn’t account for much of the variance (an adjusted R-squared of .037).</p>
<section id="post-hoc-analyses" class="level3">
<h3 class="anchored" data-anchor-id="post-hoc-analyses">Post-Hoc Analyses</h3>
<p>Perhaps we can look at how other variables might be predictive of the year of the recording.</p>
<p>Let’s look at how tempo, danceability, valence, speechiness, and energy might improve the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(album_release_year <span class="sc">~</span> tempo <span class="sc">+</span> danceability <span class="sc">+</span> valence <span class="sc">+</span> speechiness <span class="sc">+</span> energy, <span class="at">data=</span>jayz))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = album_release_year ~ tempo + danceability + valence + 
    speechiness + energy, data = jayz)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.2530  -3.4825  -0.2837   3.5690  18.2393 

Coefficients:
               Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)   2.016e+03  1.826e+00 1104.163  &lt; 2e-16 ***
tempo         2.861e-02  5.603e-03    5.105 4.12e-07 ***
danceability -5.986e+00  1.519e+00   -3.942 8.77e-05 ***
valence      -6.849e+00  9.630e-01   -7.112 2.51e-12 ***
speechiness  -7.808e+00  1.160e+00   -6.730 3.20e-11 ***
energy       -4.484e+00  1.348e+00   -3.326 0.000921 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.885 on 811 degrees of freedom
Multiple R-squared:  0.2084,    Adjusted R-squared:  0.2035 
F-statistic: 42.69 on 5 and 811 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>So we have a more predictive model, with an adjusted R-squared of about .20.</p>
<p>There are some remaining questions, however. Firstly, is there covariance at play?</p>
<p>We can use the variance inflation factor (VIF) to look at this. Typically, each variable should be less than 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>jayz_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(album_release_year <span class="sc">~</span> tempo <span class="sc">+</span> danceability <span class="sc">+</span> valence <span class="sc">+</span> speechiness <span class="sc">+</span> energy, <span class="at">data=</span>jayz)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(jayz_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       tempo danceability      valence  speechiness       energy 
    1.067352     1.350387     1.228451     1.093354     1.253967 </code></pre>
</div>
</div>
<p>A correlation plot can help us to visualize this a bit more.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>jz <span class="ot">&lt;-</span> jayz <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"acousticness"</span>, <span class="st">"liveness"</span>, <span class="st">"danceability"</span>, <span class="st">"loudness"</span>, <span class="st">"speechiness"</span>, <span class="st">"valence"</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cor</span>(jz))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(x, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             acousticness liveness danceability loudness speechiness valence
acousticness         1.00     0.14         0.07    -0.12        0.33    0.07
liveness             0.14     1.00        -0.20     0.01        0.03   -0.11
danceability         0.07    -0.20         1.00    -0.17       -0.01    0.28
loudness            -0.12     0.01        -0.17     1.00       -0.20    0.03
speechiness          0.33     0.03        -0.01    -0.20        1.00    0.18
valence              0.07    -0.11         0.28     0.03        0.18    1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(x, <span class="at">method=</span><span class="st">"pie"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="sidenote-isare-the-data-normal" class="level2">
<h2 class="anchored" data-anchor-id="sidenote-isare-the-data-normal">Sidenote: Is/Are the data normal?</h2>
<p>We can test to see if the tempo data is normally distributed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(jayz<span class="sc">$</span>tempo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jayz<span class="sc">$</span>tempo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(jayz<span class="sc">$</span>tempo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  jayz$tempo
W = 0.78869, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(jayz<span class="sc">$</span>tempo, <span class="st">"pnorm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(jayz$tempo, "pnorm"): ties should not be present for
the Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  jayz$tempo
D = 1, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>At the moment, it doesn’t seem to be…</p>
</section>
<section id="stepwise-entry-regression" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-entry-regression">Stepwise Entry Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">step</span>(<span class="fu">lm</span>(album_release_year <span class="sc">~</span> danceability <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>          tempo <span class="sc">+</span> acousticness <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>          speechiness <span class="sc">+</span> valence, <span class="at">data=</span>jayz), </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">direction=</span><span class="st">"backward"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2573.56
album_release_year ~ danceability + tempo + acousticness + speechiness + 
    valence

               Df Sum of Sq   RSS    AIC
&lt;none&gt;                      18788 2573.6
- danceability  1    243.73 19032 2582.1
- tempo         1    714.38 19502 2602.1
- acousticness  1    826.79 19614 2606.7
- speechiness   1   1422.54 20210 2631.2
- valence       1   1687.89 20476 2641.8</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = album_release_year ~ danceability + tempo + acousticness + 
    speechiness + valence, data = jayz)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.9398  -3.6858  -0.2579   3.4408  16.3345 

Coefficients:
               Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)   2.011e+03  1.257e+00 1599.612  &lt; 2e-16 ***
danceability -4.496e+00  1.386e+00   -3.244  0.00123 ** 
tempo         3.075e-02  5.538e-03    5.553 3.80e-08 ***
acousticness  6.752e+00  1.130e+00    5.974 3.46e-09 ***
speechiness  -9.233e+00  1.178e+00   -7.836 1.46e-14 ***
valence      -7.750e+00  9.080e-01   -8.536  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.813 on 811 degrees of freedom
Multiple R-squared:  0.2314,    Adjusted R-squared:  0.2267 
F-statistic: 48.83 on 5 and 811 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">step</span>(<span class="fu">lm</span>(album_release_year <span class="sc">~</span> danceability <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>          tempo <span class="sc">+</span> acousticness <span class="sc">+</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>          speechiness <span class="sc">+</span> valence, <span class="at">data=</span>jayz), </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">direction=</span><span class="st">"forward"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2573.56
album_release_year ~ danceability + tempo + acousticness + speechiness + 
    valence</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = album_release_year ~ danceability + tempo + acousticness + 
    speechiness + valence, data = jayz)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.9398  -3.6858  -0.2579   3.4408  16.3345 

Coefficients:
               Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)   2.011e+03  1.257e+00 1599.612  &lt; 2e-16 ***
danceability -4.496e+00  1.386e+00   -3.244  0.00123 ** 
tempo         3.075e-02  5.538e-03    5.553 3.80e-08 ***
acousticness  6.752e+00  1.130e+00    5.974 3.46e-09 ***
speechiness  -9.233e+00  1.178e+00   -7.836 1.46e-14 ***
valence      -7.750e+00  9.080e-01   -8.536  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.813 on 811 degrees of freedom
Multiple R-squared:  0.2314,    Adjusted R-squared:  0.2267 
F-statistic: 48.83 on 5 and 811 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="comparing-fits" class="level2">
<h2 class="anchored" data-anchor-id="comparing-fits">Comparing Fits:</h2>
<p>We could construct a few models But how can we tell which of these is more predictable? For this, we can look at <strong>Akaike’s ‘An Information Criterion’</strong>(or AIC). The lower number is better, and any difference of more than 2 is considered a statistically significant difference fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dance_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(danceability <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>acoustic_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(acousticness <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>speech_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(speechiness <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>valence_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(valence <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>tempo_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(tempo <span class="sc">~</span> album_release_year, <span class="at">data=</span>jayz)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>combined_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(album_release_year <span class="sc">~</span> tempo <span class="sc">+</span> acousticness <span class="sc">+</span> speechiness <span class="sc">+</span> valence, <span class="at">data=</span>jayz)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(dance_model, </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    acoustic_model, </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    tempo_model,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    speech_model, </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    valence_model, </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    combined_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               df        AIC
dance_model     3 -1036.7120
acoustic_model  3  -686.8298
tempo_model     3  7930.2701
speech_model    3  -782.5959
valence_model   3  -438.7779
combined_model  6  4902.6326</code></pre>
</div>
</div>
<p>The combined model doesn’t seem to do terribly well here, which seems to muddy the question up a bit.</p>
</section>
<section id="is-a-linear-model-the-best-approach" class="level2">
<h2 class="anchored" data-anchor-id="is-a-linear-model-the-best-approach">Is a linear model the best approach?</h2>
<p>We can adjust how we are viewing this data (linear or polynomial fit) a bit with the code below. Here we can plot our data as a line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jayz, <span class="fu">aes</span>(album_release_year, tempo) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">1</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And here we have it as a second order polynomial:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jayz, <span class="fu">aes</span>(album_release_year, tempo) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And we can compare fits here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(album_release_year <span class="sc">~</span> tempo, <span class="at">data =</span> jayz)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>poly_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(album_release_year <span class="sc">~</span> tempo <span class="sc">+</span> <span class="fu">I</span>(album_release_year<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> jayz)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(linear, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    poly_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       df       AIC
linear  3  5069.029
poly_2  4 -5640.652</code></pre>
</div>
</div>
</section>
<section id="predicting-a-categorical-variable" class="level2">
<h2 class="anchored" data-anchor-id="predicting-a-categorical-variable">Predicting a categorical variable</h2>
<p>What does it look like to predict a categorical variable in R? We might explore this question by hypothesizing that musical features might be predictive of mode (labeled in Spotify as major or minor: 1 or 0).</p>
<p>Here is what a binomial logistic regression would look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>jayz.log <span class="ot">&lt;-</span> <span class="fu">glm</span>(mode <span class="sc">~</span> tempo <span class="sc">+</span> danceability <span class="sc">+</span> valence <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                     speechiness <span class="sc">+</span> acousticness, <span class="at">family =</span> binomial, <span class="at">data =</span> jayz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And it looks like “speechiness” is the most predictive of mode here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jayz.log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = mode ~ tempo + danceability + valence + speechiness + 
    acousticness, family = binomial, data = jayz)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8836  -1.2367   0.9073   1.0739   1.3806  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.468e-01  5.364e-01  -0.274   0.7843    
tempo         3.210e-06  2.365e-03   0.001   0.9989    
danceability  1.062e-01  5.893e-01   0.180   0.8570    
valence      -5.733e-01  3.911e-01  -1.466   0.1427    
speechiness   2.561e+00  5.483e-01   4.671    3e-06 ***
acousticness -9.680e-01  4.849e-01  -1.996   0.0459 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1120.6  on 816  degrees of freedom
Residual deviance: 1095.8  on 811  degrees of freedom
AIC: 1107.8

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>We can plot the log odds ratios as well:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(jayz.log))[<span class="sc">-</span><span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(jayz.log,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.lim =</span> <span class="fu">c</span>(<span class="fu">min</span>(CI), <span class="fu">max</span>(CI)),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">auto.label =</span> F,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show.values =</span> T) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="wednesday" class="level1">
<h1>Wednesday</h1>
<section id="clustering" class="level2">
<h2 class="anchored" data-anchor-id="clustering">Clustering</h2>
<p>Cluster analysis is a form of statistical data analysis in which subsets (called “clusters”) are formed according to some notion of similarity. There are many different variants of cluster analysis, but most are hierarchical–in which low-level clusters are successively joined together to make larger clusters, and so on, until everything is clustered into one large group. The result is a cluster tree or <em>dendrogram</em>.</p>
<section id="how-does-the-r-hclust-function-work" class="level3">
<h3 class="anchored" data-anchor-id="how-does-the-r-hclust-function-work">How does the R hclust function work?</h3>
<p>The <strong>hclust</strong> function is part of the default package in R, and it clusters based on dissimilarities in the data. There are different algorithms it can use, but the default is <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.3/topics/hclust">Ward’s minimum variance</a>. It requires some distance to be calculated first, so the <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.3/topics/dist"><em>dist</em></a> function is used on the data. Again there are many options here, but the default is to simply calculate the Euclidean distance between the values.</p>
<p>The documentation states:</p>
<blockquote class="blockquote">
<p>This function performs a hierarchical cluster analysis using a set of dissimilarities for the <em>n</em> objects being clustered. Initially, each object is assigned to its own cluster and then the algorithm proceeds iteratively, at each stage joining the two most similar clusters, continuing until there is just a single cluster. At each stage distances between clusters are recomputed by the Lance–Williams dissimilarity update formula according to the particular clustering method being used.</p>
</blockquote>
<p>The default is Ward’s minimum variance method, which:</p>
<blockquote class="blockquote">
<p>aims at finding compact, spherical clusters. The complete linkage method finds similar clusters.</p>
</blockquote>
<p>Another method is the “single linkage method”.</p>
<blockquote class="blockquote">
<p>The single linkage method (which is closely related to the minimal spanning tree) adopts a ‘friends of friends’ clustering strategy. The other methods can be regarded as aiming for clusters with characteristics somewhere between the single and complete link methods. Note however, that methods “median” and “centroid” are not leading to a monotone distance measure, or equivalently the resulting dendrograms can have so called inversions or reversals which are hard to interpret, but note the trichotomies in Legendre and Legendre (2012).</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster demo modified from here: </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">### https://www.r-bloggers.com/2021/04/cluster-analysis-in-r/</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>beyonce <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"beyonce.csv"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>taylor <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"taylor.csv"</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> beyonce <span class="sc">%&gt;%</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(album_name <span class="sc">==</span> <span class="st">"4"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"track_name"</span>, <span class="st">"acousticness"</span>, <span class="st">"liveness"</span>, <span class="st">"danceability"</span>, <span class="st">"loudness"</span>, <span class="st">"speechiness"</span>, <span class="st">"valence"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(track_name, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="do">## cleaning up the data.</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> df[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)]</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="do">### getting means of each category.</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">apply</span>(z,<span class="dv">2</span>,mean)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="do">### getting standard deviation of each category.</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(z,<span class="dv">2</span>,sd)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="do">### scales the data in the matrix.</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="ot">&lt;-</span> <span class="fu">scale</span>(z,<span class="at">center=</span>means,<span class="at">scale=</span>sds)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="fu">dist</span>(scaled_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we can plot the data like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">### helps with the size of the image.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mar = c(1, 1, 1, 1))</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="do">### creates the cluster</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>df.hclust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distance)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="do">### plots the data but with row numbers.</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df.hclust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And we can add the track name like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df.hclust,<span class="at">labels=</span>df<span class="sc">$</span>track_name,<span class="at">main=</span><span class="st">'Default from hclust'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can clean up the plot the be along a single x-axis with the <code>hang</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df.hclust,<span class="at">hang=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">labels=</span>df<span class="sc">$</span>track_name,<span class="at">main=</span><span class="st">'Default from hclust'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="which-track-belongs-to-which-cluster" class="level2">
<h2 class="anchored" data-anchor-id="which-track-belongs-to-which-cluster">Which track belongs to which cluster?</h2>
<p>It might be helpful with this analysis to look at how each of the songs fits on the tree. We can use the <code>cutree</code> function, which “cuts a tree” from the cluster based on how many groups we ask it for.</p>
<p>The following code can tell us how many fall into each broader tree, assuming we think that the tree should be cut into three. Notice that the third branch is the most populous, with the second being the most sparsely populated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>member <span class="ot">&lt;-</span> <span class="fu">cutree</span>(df.hclust,<span class="dv">3</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(member)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>member
 1  2  3 
 4  3 11 </code></pre>
</div>
</div>
<p>But how is each category being weighted? The code below shows that acousticness and danceability do a fair bit of work in separating groups 1 and 3, and valence separates 1 and 2 from one another.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">##but how are these clusters calculated?</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(scaled_data,<span class="fu">list</span>(member),mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Group.1 acousticness   liveness danceability   loudness speechiness
1       1    1.2293770 -0.3037203   -1.5341655 -0.4289046   0.3971934
2       2    0.6165508 -0.5097641    0.5152708 -1.0002027   1.0862774
3       3   -0.6151964  0.2494703    0.4173500  0.4287478  -0.4406914
     valence
1 -1.2506018
2  1.0310423
3  0.1735709</code></pre>
</div>
</div>
<p>A slightly more even split occurs if we break it into four groups rather than three.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>member <span class="ot">&lt;-</span> <span class="fu">cutree</span>(df.hclust,<span class="dv">4</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(member)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>member
1 2 3 4 
4 3 9 2 </code></pre>
</div>
</div>
<p>And that how they’re split into four is a bit different from how we might split them into three, but danceability and acousticness still playing a strong role.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(scaled_data,<span class="fu">list</span>(member),mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Group.1 acousticness   liveness danceability   loudness speechiness
1       1    1.2293770 -0.3037203   -1.5341655 -0.4289046   0.3971934
2       2    0.6165508 -0.5097641    0.5152708 -1.0002027   1.0862774
3       3   -0.6115250 -0.1547202    0.4044253  0.3613888  -0.5628163
4       4   -0.6317177  2.0683279    0.4755110  0.7318636   0.1088705
      valence
1 -1.25060184
2  1.03104230
3  0.05196371
4  0.72080353</code></pre>
</div>
</div>
<section id="k-means-clustering" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering">K-Means Clustering</h3>
<p>We can also run a simple k-means clustering on the data. With this, we are clustering the data into <em>k</em> groups. R’s documentation explains it like so:</p>
<blockquote class="blockquote">
<p>aims to partition the points into <em>k</em> groups such that the sum of squares from points to the assigned cluster centres is minimized. At the minimum, all cluster centres are at the mean of their Voronoi sets (the set of data points which are nearest to the cluster centre).</p>
</blockquote>
<p>There are a few algorithms to pick from. R uses the Hartigan and Wong (1979) algorithm by default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">###split it into three groups</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>kc <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(scaled_data,<span class="dv">3</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="do">### add labels.</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(scaled_data) <span class="ot">&lt;-</span> df<span class="sc">$</span>track_name</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="do">###get the shortest distance.</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>datadistshortset<span class="ot">&lt;-</span><span class="fu">dist</span>(scaled_data,<span class="at">method =</span> <span class="st">"euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code below will cluster it based on this k-means clustering distance, and plot them into the amount of groups listed (here 3).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>hc1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(datadistshortset, <span class="at">method =</span> <span class="st">"complete"</span> )</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>pamvshortset <span class="ot">&lt;-</span> <span class="fu">pam</span>(datadistshortset,<span class="dv">3</span>, <span class="at">diss =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">clusplot</span>(pamvshortset, <span class="at">shade =</span> <span class="cn">FALSE</span>,<span class="at">labels=</span><span class="dv">2</span>,<span class="at">col.clus=</span><span class="st">"blue"</span>,<span class="at">col.p=</span><span class="st">"red"</span>,<span class="at">span=</span><span class="cn">FALSE</span>,<span class="at">main=</span><span class="st">"Cluster Mapping"</span>,<span class="at">cex=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="example-1-looking-at-nirvana-albumss" class="level2">
<h2 class="anchored" data-anchor-id="example-1-looking-at-nirvana-albumss">Example 1: Looking at Nirvana Albumss</h2>
<p>I’m going to get the global features from Nirvana, and specifically I’m just going to look at the <em>Unplugged in New York</em> album. I do this in two, rather inefficient, steps: I get all of the Nirvana data and put those in a dataframe, and then I create a variable that has filtered out only the specific album I’m looking for.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>nirvana <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'nirvana'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>unplugged <span class="ot">&lt;-</span> <span class="fu">filter</span>(nirvana, album_name <span class="sc">==</span> <span class="st">"MTV Unplugged In New York"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">filter</span>(nirvana, album_name <span class="sc">==</span> <span class="st">"MTV Unplugged In New York"</span>  <span class="sc">|</span> album_name <span class="sc">==</span> <span class="st">"Nevermind"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gets lots of data, and I’m just interested in their global measures (tempo, danceability, liveness, etc.). Here, I’ve gone with column number rather than name, but the other version might be a bit easier/cleaner. Nevertheless, this is another way of doing it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">###i've just picked out the columns I want.</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>selected <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">30</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="do">### This subsets the data based on only the columns I want.</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>unplugged <span class="ot">&lt;-</span> unplugged[,selected]</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="do">### I assign the track name column (30) with the rownames, to have a labeled cluster.</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(unplugged) <span class="ot">&lt;-</span> unplugged<span class="sc">$</span>track_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(unplugged), <span class="at">method =</span> <span class="st">"complete"</span>, <span class="at">members =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dist(unplugged): NAs introduced by coercion</code></pre>
</div>
</div>
<section id="plotting-the-cluster" class="level4">
<h4 class="anchored" data-anchor-id="plotting-the-cluster">Plotting the cluster</h4>
<p>Technically, you could just use the plot function at this point, but there are some long title names, so I added these extra plot options to make the text smaller and increase the marins.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">0.5</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">main=</span><span class="st">""</span>, <span class="at">sub=</span><span class="st">""</span>, <span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">xlab=</span><span class="st">"tunes"</span>, <span class="at">ylab=</span><span class="st">"height"</span>, <span class="at">main=</span><span class="st">"Nirvana unplugged"</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot is a bit strange now, as we have a pretty big negative number on the y-axis. Nevertheless, we see some cool things. The songs written by the Meat Puppets cluster together, for example.</p>
</section>
<section id="k-means-clustering-1" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering-1">k-means clustering</h3>
<p>Our next type of clustering analysis is be a <strong>k-means cluster</strong>. We will start off by using a <a href="https://en.wikipedia.org/wiki/Scree_plot">scree plot</a> to see how many clusters we should use. There are a number of ways of analyzing where an “elbow” on this plot might be, but many people actually just eyeball it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>unplugged <span class="ot">&lt;-</span> <span class="fu">filter</span>(nirvana, album_name <span class="sc">==</span> <span class="st">"MTV Unplugged In New York"</span> )</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>titles <span class="ot">&lt;-</span> unplugged<span class="sc">$</span>track_name</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>unplugged <span class="ot">&lt;-</span> unplugged[,selected]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>unplugged <span class="ot">&lt;-</span> <span class="fu">scale</span>(unplugged[,<span class="sc">-</span><span class="dv">10</span>]) <span class="co"># standardize variables</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>unplugged <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(unplugged) <span class="co"># standardize variables</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine number of clusters</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(unplugged)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sum</span>(<span class="fu">apply</span>(unplugged,<span class="dv">2</span>,var))</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>) wss[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">kmeans</span>(unplugged, </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">centers=</span>i)<span class="sc">$</span>withinss)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, wss, <span class="at">type=</span><span class="st">"b"</span>, <span class="at">xlab=</span><span class="st">"Number of Clusters"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">"Within groups sum of squares"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And now we can look at the k-means clustering based on however many clusters we think are necessary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K-Means Cluster Analysis</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(unplugged, <span class="dv">3</span>) <span class="co"># 3 cluster solution</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get cluster means </span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(unplugged,<span class="at">by=</span><span class="fu">list</span>(fit<span class="sc">$</span>cluster),<span class="at">FUN=</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Group.1 danceability     energy   loudness speechiness acousticness
1       1     1.026773  0.1850689  0.4603061 -0.67242123    0.5744139
2       2    -0.466715  0.7286156  0.3748797  0.92850767   -1.1595582
3       3    -0.653401 -0.7679614 -0.7602098 -0.07038491    0.3532327
  instrumentalness    liveness    valence      tempo
1       -0.1528028  0.59048330  0.5986320  0.1965621
2       -0.3318123  0.09159538  0.4107587  0.7767115
3        0.4182526 -0.66375960 -0.9272390 -0.8179312</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># append cluster assignment</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>unplugged_appended <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(unplugged, fit<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(unplugged_appended) <span class="ot">=</span> titles</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">clusplot</span>(unplugged_appended, fit<span class="sc">$</span>cluster, <span class="at">color=</span><span class="cn">TRUE</span>, <span class="at">shade=</span><span class="cn">TRUE</span>, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">labels=</span><span class="dv">3</span>, <span class="at">lines=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="conditional-inference-tree-with-party" class="level2">
<h2 class="anchored" data-anchor-id="conditional-inference-tree-with-party">Conditional Inference Tree with Party</h2>
<p>A conditional inference tree is basically a regression tree, and it tells you exactly how it picks apart the data in a pretty clear way.</p>
<p>I’ve always thought that Weezer was a bit derivative, so we might look at how we can separate them other (much better) bands, like Pavement…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>pavement <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'pavement'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>weezer <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'weezer'</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>pavement_weezer <span class="ot">&lt;-</span><span class="fu">rbind</span>(pavement, weezer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s a regression tree that tries to account for the variance between deciding whether a piece is from Pavement or Weezer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rpart</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grow tree </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(<span class="fu">as.factor</span>(artist_name) <span class="sc">~</span> danceability <span class="sc">+</span> valence <span class="sc">+</span> tempo <span class="sc">+</span> liveness,  <span class="at">data=</span>pavement_weezer)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(fit) <span class="co"># display the results </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Classification tree:
rpart(formula = as.factor(artist_name) ~ danceability + valence + 
    tempo + liveness, data = pavement_weezer)

Variables actually used in tree construction:
[1] danceability liveness     valence     

Root node error: 349/979 = 0.35649

n= 979 

        CP nsplit rel error  xerror     xstd
1 0.047755      0   1.00000 1.00000 0.042940
2 0.022923      4   0.80516 0.89398 0.041776
3 0.020057      5   0.78223 0.85960 0.041331
4 0.010000      6   0.76218 0.85673 0.041293</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(fit) <span class="co"># visualize cross-validation results </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit) <span class="co"># detailed summary of splits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = as.factor(artist_name) ~ danceability + valence + 
    tempo + liveness, data = pavement_weezer)
  n= 979 

          CP nsplit rel error    xerror       xstd
1 0.04775549      0 1.0000000 1.0000000 0.04294041
2 0.02292264      4 0.8051576 0.8939828 0.04177567
3 0.02005731      5 0.7822350 0.8595989 0.04133127
4 0.01000000      6 0.7621777 0.8567335 0.04129270

Variable importance
danceability      valence     liveness        tempo 
          61           28           10            1 

Node number 1: 979 observations,    complexity param=0.04775549
  predicted class=Weezer    expected loss=0.3564862  P(node) =1
    class counts:   349   630
   probabilities: 0.356 0.644 
  left son=2 (618 obs) right son=3 (361 obs)
  Primary splits:
      danceability &lt; 0.522    to the left,  improve=43.858290, (0 missing)
      valence      &lt; 0.2975   to the left,  improve=13.962690, (0 missing)
      tempo        &lt; 142.843  to the right, improve= 7.641565, (0 missing)
      liveness     &lt; 0.05625  to the right, improve= 6.520634, (0 missing)
  Surrogate splits:
      valence  &lt; 0.5905   to the left,  agree=0.697, adj=0.177, (0 split)
      liveness &lt; 0.05625  to the right, agree=0.647, adj=0.042, (0 split)
      tempo    &lt; 76.103   to the right, agree=0.635, adj=0.011, (0 split)

Node number 2: 618 observations,    complexity param=0.04775549
  predicted class=Weezer    expected loss=0.4708738  P(node) =0.6312564
    class counts:   291   327
   probabilities: 0.471 0.529 
  left son=4 (53 obs) right son=5 (565 obs)
  Primary splits:
      liveness     &lt; 0.5765   to the right, improve=7.022553, (0 missing)
      valence      &lt; 0.1925   to the left,  improve=6.959549, (0 missing)
      danceability &lt; 0.404    to the left,  improve=5.352002, (0 missing)
      tempo        &lt; 125.6825 to the left,  improve=4.458552, (0 missing)

Node number 3: 361 observations
  predicted class=Weezer    expected loss=0.1606648  P(node) =0.3687436
    class counts:    58   303
   probabilities: 0.161 0.839 

Node number 4: 53 observations
  predicted class=Pavement  expected loss=0.2830189  P(node) =0.05413687
    class counts:    38    15
   probabilities: 0.717 0.283 

Node number 5: 565 observations,    complexity param=0.04775549
  predicted class=Weezer    expected loss=0.4477876  P(node) =0.5771195
    class counts:   253   312
   probabilities: 0.448 0.552 
  left son=10 (61 obs) right son=11 (504 obs)
  Primary splits:
      valence      &lt; 0.6655   to the right, improve=10.232180, (0 missing)
      danceability &lt; 0.5165   to the right, improve= 4.949092, (0 missing)
      tempo        &lt; 77.8915  to the left,  improve= 3.823105, (0 missing)
      liveness     &lt; 0.09715  to the left,  improve= 3.710828, (0 missing)

Node number 10: 61 observations
  predicted class=Pavement  expected loss=0.2786885  P(node) =0.06230848
    class counts:    44    17
   probabilities: 0.721 0.279 

Node number 11: 504 observations,    complexity param=0.04775549
  predicted class=Weezer    expected loss=0.4146825  P(node) =0.514811
    class counts:   209   295
   probabilities: 0.415 0.585 
  left son=22 (98 obs) right son=23 (406 obs)
  Primary splits:
      valence      &lt; 0.192    to the left,  improve=7.635957, (0 missing)
      danceability &lt; 0.5165   to the right, improve=4.863906, (0 missing)
      tempo        &lt; 77.8915  to the left,  improve=3.964739, (0 missing)
      liveness     &lt; 0.3565   to the left,  improve=3.188013, (0 missing)
  Surrogate splits:
      tempo        &lt; 202.119  to the right, agree=0.813, adj=0.041, (0 split)
      danceability &lt; 0.196    to the left,  agree=0.812, adj=0.031, (0 split)

Node number 22: 98 observations,    complexity param=0.02292264
  predicted class=Pavement  expected loss=0.4081633  P(node) =0.1001021
    class counts:    58    40
   probabilities: 0.592 0.408 
  left son=44 (90 obs) right son=45 (8 obs)
  Primary splits:
      danceability &lt; 0.497    to the left,  improve=6.102494, (0 missing)
      liveness     &lt; 0.09655  to the left,  improve=4.191436, (0 missing)
      tempo        &lt; 130.712  to the right, improve=3.409439, (0 missing)
      valence      &lt; 0.113    to the right, improve=1.896793, (0 missing)

Node number 23: 406 observations,    complexity param=0.02005731
  predicted class=Weezer    expected loss=0.3719212  P(node) =0.4147089
    class counts:   151   255
   probabilities: 0.372 0.628 
  left son=46 (7 obs) right son=47 (399 obs)
  Primary splits:
      danceability &lt; 0.5165   to the right, improve=5.619653, (0 missing)
      valence      &lt; 0.22     to the right, improve=3.489861, (0 missing)
      liveness     &lt; 0.363    to the left,  improve=2.817898, (0 missing)
      tempo        &lt; 124.612  to the left,  improve=2.773645, (0 missing)

Node number 44: 90 observations
  predicted class=Pavement  expected loss=0.3555556  P(node) =0.09193054
    class counts:    58    32
   probabilities: 0.644 0.356 

Node number 45: 8 observations
  predicted class=Weezer    expected loss=0  P(node) =0.008171604
    class counts:     0     8
   probabilities: 0.000 1.000 

Node number 46: 7 observations
  predicted class=Pavement  expected loss=0  P(node) =0.007150153
    class counts:     7     0
   probabilities: 1.000 0.000 

Node number 47: 399 observations
  predicted class=Weezer    expected loss=0.3609023  P(node) =0.4075587
    class counts:   144   255
   probabilities: 0.361 0.639 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot tree </span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit, <span class="at">uniform=</span><span class="cn">TRUE</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">main=</span><span class="st">"Regression Tree for Pavement/Weezer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="christmas-or-not" class="level2">
<h2 class="anchored" data-anchor-id="christmas-or-not">Christmas or Not?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>christmas <span class="ot">&lt;-</span> <span class="fu">get_playlist_audio_features</span>(<span class="st">""</span>, <span class="st">"5OP7itTh52BMfZS1DJrdlv"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>christmas<span class="sc">$</span>christmas <span class="ot">&lt;-</span> <span class="st">"yes"</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>not <span class="ot">&lt;-</span> <span class="fu">get_playlist_audio_features</span>(<span class="st">""</span>, <span class="st">"6i2Qd6OpeRBAzxfscNXeWp"</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>not<span class="sc">$</span>christmas <span class="ot">&lt;-</span> <span class="st">"no"</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>christmas_not <span class="ot">&lt;-</span><span class="fu">rbind</span>(christmas, not)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(<span class="fu">as.factor</span>(christmas) <span class="sc">~</span> danceability <span class="sc">+</span> valence <span class="sc">+</span> tempo <span class="sc">+</span> liveness <span class="sc">+</span> tempo <span class="sc">+</span> mode, <span class="at">data=</span>christmas_not)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot tree </span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit, <span class="at">uniform=</span><span class="cn">TRUE</span>, </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">main=</span><span class="st">"Regression Tree for Christmas/Not"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_5_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(not<span class="sc">$</span>mode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 0  1 
33 81 </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../class_notes/week_4.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Week 4: Conceptual Debates: Key-Finding</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2023, Daniel Shanahan</div>   
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>